Matplotlib created a temporary cache directory at /scratch/90102/matplotlib-17b3r_lt because the default path (/home/imhof/.config/matplotlib) is not a writable directory; it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/storage/ukp/work/imhof/miniconda3/envs/gips/lib/python3.12/site-packages/pytorch_lightning/trainer/connectors/logger_connector/logger_connector.py:75: Starting from v1.9.0, `tensorboardX` has been removed as a dependency of the `pytorch_lightning` package, due to potential conflicts with other packages in the ML ecosystem. For this reason, `logger=True` will use `CSVLogger` as the default logger, unless the `tensorboard` or `tensorboardX` packages are found. Please `pip install lightning[extra]` or one of them to enable TensorBoard support by default
/mnt/beegfs/work/imhof/gips/osv5m/data/data.py:316: RuntimeWarning: divide by zero encountered in divide
  weights = 1.0 / np.power(hist[df["lon_bin"], df["lat_bin"]], 0.75)
/mnt/beegfs/work/imhof/gips/osv5m/data/data.py:317: RuntimeWarning: invalid value encountered in divide
  normalized_weights = weights / np.sum(weights)
/mnt/beegfs/work/imhof/gips/osv5m/data/data.py:389: DtypeWarning: Columns (11,27) have mixed types. Specify dtype option on import or set low_memory=False.
  pd.read_csv(join(self.path, f"{split}.csv"))[tag]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
SLURM auto-requeueing enabled. Setting signal handlers.
Each GPU will receive 1024 images
Stage TrainerFn.TESTING
Loading categories from ['train']
Test dataset size: 210122
Setup took 39.70 seconds
Testing: |          | 0/? [00:00<?, ?it/s]Testing:   0%|          | 0/206 [00:00<?, ?it/s]Testing DataLoader 0:   0%|          | 0/206 [00:00<?, ?it/s]/storage/ukp/work/imhof/miniconda3/envs/gips/lib/python3.12/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at ../aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
Loading formatted geocoded file...
Testing DataLoader 0:   0%|          | 1/206 [00:18<1:04:33,  0.05it/s]Testing DataLoader 0:   1%|          | 2/206 [00:36<1:02:17,  0.05it/s]Testing DataLoader 0:   1%|▏         | 3/206 [00:54<1:01:24,  0.06it/s]Testing DataLoader 0:   2%|▏         | 4/206 [01:12<1:00:42,  0.06it/s]Testing DataLoader 0:   2%|▏         | 5/206 [01:29<1:00:13,  0.06it/s]Testing DataLoader 0:   3%|▎         | 6/206 [01:47<59:47,  0.06it/s]  Testing DataLoader 0:   3%|▎         | 7/206 [02:05<59:27,  0.06it/s]Testing DataLoader 0:   4%|▍         | 8/206 [02:23<59:06,  0.06it/s]Testing DataLoader 0:   4%|▍         | 9/206 [02:41<58:46,  0.06it/s]Testing DataLoader 0:   5%|▍         | 10/206 [02:58<58:27,  0.06it/s]Testing DataLoader 0:   5%|▌         | 11/206 [03:16<58:08,  0.06it/s]Testing DataLoader 0:   6%|▌         | 12/206 [03:34<57:49,  0.06it/s]Testing DataLoader 0:   6%|▋         | 13/206 [03:52<57:29,  0.06it/s]Testing DataLoader 0:   7%|▋         | 14/206 [04:10<57:13,  0.06it/s]Testing DataLoader 0:   7%|▋         | 15/206 [04:28<56:55,  0.06it/s]Testing DataLoader 0:   8%|▊         | 16/206 [04:46<56:37,  0.06it/s]Testing DataLoader 0:   8%|▊         | 17/206 [05:04<56:20,  0.06it/s]Testing DataLoader 0:   9%|▊         | 18/206 [05:21<56:02,  0.06it/s]Testing DataLoader 0:   9%|▉         | 19/206 [05:39<55:44,  0.06it/s]Testing DataLoader 0:  10%|▉         | 20/206 [05:57<55:26,  0.06it/s]Testing DataLoader 0:  10%|█         | 21/206 [06:15<55:09,  0.06it/s]Testing DataLoader 0:  11%|█         | 22/206 [06:33<54:51,  0.06it/s]Testing DataLoader 0:  11%|█         | 23/206 [06:51<54:34,  0.06it/s]Testing DataLoader 0:  12%|█▏        | 24/206 [07:09<54:16,  0.06it/s]Testing DataLoader 0:  12%|█▏        | 25/206 [07:27<53:59,  0.06it/s]Testing DataLoader 0:  13%|█▎        | 26/206 [07:45<53:42,  0.06it/s]Testing DataLoader 0:  13%|█▎        | 27/206 [08:03<53:24,  0.06it/s]Testing DataLoader 0:  14%|█▎        | 28/206 [08:21<53:06,  0.06it/s]Testing DataLoader 0:  14%|█▍        | 29/206 [08:39<52:48,  0.06it/s]Testing DataLoader 0:  15%|█▍        | 30/206 [08:57<52:30,  0.06it/s]Testing DataLoader 0:  15%|█▌        | 31/206 [09:14<52:13,  0.06it/s]Testing DataLoader 0:  16%|█▌        | 32/206 [09:32<51:55,  0.06it/s]Testing DataLoader 0:  16%|█▌        | 33/206 [09:50<51:37,  0.06it/s]Testing DataLoader 0:  17%|█▋        | 34/206 [10:08<51:19,  0.06it/s]Testing DataLoader 0:  17%|█▋        | 35/206 [10:26<51:01,  0.06it/s]Testing DataLoader 0:  17%|█▋        | 36/206 [10:44<50:43,  0.06it/s]Testing DataLoader 0:  18%|█▊        | 37/206 [11:02<50:25,  0.06it/s]Testing DataLoader 0:  18%|█▊        | 38/206 [11:20<50:07,  0.06it/s]Testing DataLoader 0:  19%|█▉        | 39/206 [11:38<49:49,  0.06it/s]Testing DataLoader 0:  19%|█▉        | 40/206 [11:56<49:31,  0.06it/s]Testing DataLoader 0:  20%|█▉        | 41/206 [12:13<49:13,  0.06it/s]Testing DataLoader 0:  20%|██        | 42/206 [12:31<48:55,  0.06it/s]Testing DataLoader 0:  21%|██        | 43/206 [12:49<48:37,  0.06it/s]Testing DataLoader 0:  21%|██▏       | 44/206 [13:07<48:20,  0.06it/s]Testing DataLoader 0:  22%|██▏       | 45/206 [13:25<48:02,  0.06it/s]Testing DataLoader 0:  22%|██▏       | 46/206 [13:43<47:44,  0.06it/s]Testing DataLoader 0:  23%|██▎       | 47/206 [14:01<47:26,  0.06it/s]Testing DataLoader 0:  23%|██▎       | 48/206 [14:19<47:08,  0.06it/s]Testing DataLoader 0:  24%|██▍       | 49/206 [14:37<46:51,  0.06it/s]Testing DataLoader 0:  24%|██▍       | 50/206 [14:55<46:33,  0.06it/s]Testing DataLoader 0:  25%|██▍       | 51/206 [15:13<46:15,  0.06it/s]Testing DataLoader 0:  25%|██▌       | 52/206 [15:31<45:57,  0.06it/s]Testing DataLoader 0:  26%|██▌       | 53/206 [15:54<45:54,  0.06it/s]Testing DataLoader 0:  26%|██▌       | 54/206 [16:12<45:36,  0.06it/s]Testing DataLoader 0:  27%|██▋       | 55/206 [16:29<45:17,  0.06it/s]Testing DataLoader 0:  27%|██▋       | 56/206 [16:47<44:59,  0.06it/s]Testing DataLoader 0:  28%|██▊       | 57/206 [17:05<44:40,  0.06it/s]Testing DataLoader 0:  28%|██▊       | 58/206 [17:23<44:22,  0.06it/s]Testing DataLoader 0:  29%|██▊       | 59/206 [17:41<44:04,  0.06it/s]Testing DataLoader 0:  29%|██▉       | 60/206 [17:59<43:46,  0.06it/s]Testing DataLoader 0:  30%|██▉       | 61/206 [18:17<43:27,  0.06it/s]Testing DataLoader 0:  30%|███       | 62/206 [18:35<43:10,  0.06it/s]Testing DataLoader 0:  31%|███       | 63/206 [18:53<42:51,  0.06it/s]Testing DataLoader 0:  31%|███       | 64/206 [19:10<42:33,  0.06it/s]Testing DataLoader 0:  32%|███▏      | 65/206 [19:28<42:15,  0.06it/s]Testing DataLoader 0:  32%|███▏      | 66/206 [19:46<41:57,  0.06it/s]Testing DataLoader 0:  33%|███▎      | 67/206 [20:04<41:38,  0.06it/s]Testing DataLoader 0:  33%|███▎      | 68/206 [20:22<41:20,  0.06it/s]Testing DataLoader 0:  33%|███▎      | 69/206 [20:40<41:02,  0.06it/s]Testing DataLoader 0:  34%|███▍      | 70/206 [20:58<40:44,  0.06it/s]Testing DataLoader 0:  34%|███▍      | 71/206 [21:15<40:25,  0.06it/s]Testing DataLoader 0:  35%|███▍      | 72/206 [21:33<40:07,  0.06it/s]Testing DataLoader 0:  35%|███▌      | 73/206 [21:51<39:49,  0.06it/s]Testing DataLoader 0:  36%|███▌      | 74/206 [22:09<39:31,  0.06it/s]Testing DataLoader 0:  36%|███▋      | 75/206 [22:27<39:13,  0.06it/s]Testing DataLoader 0:  37%|███▋      | 76/206 [22:45<38:55,  0.06it/s]Testing DataLoader 0:  37%|███▋      | 77/206 [23:03<38:37,  0.06it/s]Testing DataLoader 0:  38%|███▊      | 78/206 [23:21<38:19,  0.06it/s]Testing DataLoader 0:  38%|███▊      | 79/206 [23:38<38:01,  0.06it/s]Testing DataLoader 0:  39%|███▉      | 80/206 [23:56<37:43,  0.06it/s]Testing DataLoader 0:  39%|███▉      | 81/206 [24:14<37:24,  0.06it/s]Testing DataLoader 0:  40%|███▉      | 82/206 [24:32<37:06,  0.06it/s]Testing DataLoader 0:  40%|████      | 83/206 [24:50<36:48,  0.06it/s]Testing DataLoader 0:  41%|████      | 84/206 [25:08<36:30,  0.06it/s]Testing DataLoader 0:  41%|████▏     | 85/206 [25:26<36:12,  0.06it/s]Testing DataLoader 0:  42%|████▏     | 86/206 [25:44<35:54,  0.06it/s]Testing DataLoader 0:  42%|████▏     | 87/206 [26:02<35:36,  0.06it/s]Testing DataLoader 0:  43%|████▎     | 88/206 [26:19<35:18,  0.06it/s]Testing DataLoader 0:  43%|████▎     | 89/206 [26:37<35:00,  0.06it/s]Testing DataLoader 0:  44%|████▎     | 90/206 [26:55<34:42,  0.06it/s]Testing DataLoader 0:  44%|████▍     | 91/206 [27:13<34:24,  0.06it/s]Testing DataLoader 0:  45%|████▍     | 92/206 [27:31<34:06,  0.06it/s]Testing DataLoader 0:  45%|████▌     | 93/206 [27:49<33:48,  0.06it/s]Testing DataLoader 0:  46%|████▌     | 94/206 [28:07<33:30,  0.06it/s]Testing DataLoader 0:  46%|████▌     | 95/206 [28:24<33:12,  0.06it/s]Testing DataLoader 0:  47%|████▋     | 96/206 [28:42<32:54,  0.06it/s]Testing DataLoader 0:  47%|████▋     | 97/206 [29:00<32:35,  0.06it/s]Testing DataLoader 0:  48%|████▊     | 98/206 [29:18<32:17,  0.06it/s]Testing DataLoader 0:  48%|████▊     | 99/206 [29:36<31:59,  0.06it/s]Testing DataLoader 0:  49%|████▊     | 100/206 [29:53<31:41,  0.06it/s]Testing DataLoader 0:  49%|████▉     | 101/206 [30:11<31:23,  0.06it/s]Testing DataLoader 0:  50%|████▉     | 102/206 [30:29<31:05,  0.06it/s]Testing DataLoader 0:  50%|█████     | 103/206 [30:47<30:47,  0.06it/s]Testing DataLoader 0:  50%|█████     | 104/206 [31:05<30:29,  0.06it/s]Testing DataLoader 0:  51%|█████     | 105/206 [31:23<30:11,  0.06it/s]Testing DataLoader 0:  51%|█████▏    | 106/206 [31:41<29:53,  0.06it/s]Testing DataLoader 0:  52%|█████▏    | 107/206 [31:58<29:35,  0.06it/s]Testing DataLoader 0:  52%|█████▏    | 108/206 [32:16<29:17,  0.06it/s]Testing DataLoader 0:  53%|█████▎    | 109/206 [32:34<28:59,  0.06it/s]Testing DataLoader 0:  53%|█████▎    | 110/206 [32:52<28:41,  0.06it/s]Testing DataLoader 0:  54%|█████▍    | 111/206 [33:10<28:23,  0.06it/s]Testing DataLoader 0:  54%|█████▍    | 112/206 [33:28<28:05,  0.06it/s]Testing DataLoader 0:  55%|█████▍    | 113/206 [33:46<27:47,  0.06it/s]Testing DataLoader 0:  55%|█████▌    | 114/206 [34:04<27:29,  0.06it/s]Testing DataLoader 0:  56%|█████▌    | 115/206 [34:21<27:11,  0.06it/s]Testing DataLoader 0:  56%|█████▋    | 116/206 [34:39<26:53,  0.06it/s]Testing DataLoader 0:  57%|█████▋    | 117/206 [34:57<26:35,  0.06it/s]Testing DataLoader 0:  57%|█████▋    | 118/206 [35:15<26:17,  0.06it/s]Testing DataLoader 0:  58%|█████▊    | 119/206 [35:33<25:59,  0.06it/s]Testing DataLoader 0:  58%|█████▊    | 120/206 [35:51<25:41,  0.06it/s]Testing DataLoader 0:  59%|█████▊    | 121/206 [36:09<25:23,  0.06it/s]Testing DataLoader 0:  59%|█████▉    | 122/206 [36:27<25:06,  0.06it/s]Testing DataLoader 0:  60%|█████▉    | 123/206 [36:45<24:48,  0.06it/s]Testing DataLoader 0:  60%|██████    | 124/206 [37:03<24:30,  0.06it/s]Testing DataLoader 0:  61%|██████    | 125/206 [37:21<24:12,  0.06it/s]Testing DataLoader 0:  61%|██████    | 126/206 [37:39<23:54,  0.06it/s]Testing DataLoader 0:  62%|██████▏   | 127/206 [37:57<23:36,  0.06it/s]Testing DataLoader 0:  62%|██████▏   | 128/206 [38:14<23:18,  0.06it/s]Testing DataLoader 0:  63%|██████▎   | 129/206 [38:32<23:00,  0.06it/s]Testing DataLoader 0:  63%|██████▎   | 130/206 [38:50<22:42,  0.06it/s]Testing DataLoader 0:  64%|██████▎   | 131/206 [39:08<22:24,  0.06it/s]Testing DataLoader 0:  64%|██████▍   | 132/206 [39:26<22:06,  0.06it/s]Testing DataLoader 0:  65%|██████▍   | 133/206 [39:44<21:48,  0.06it/s]Testing DataLoader 0:  65%|██████▌   | 134/206 [40:02<21:30,  0.06it/s]Testing DataLoader 0:  66%|██████▌   | 135/206 [40:20<21:12,  0.06it/s]Testing DataLoader 0:  66%|██████▌   | 136/206 [40:37<20:54,  0.06it/s]Testing DataLoader 0:  67%|██████▋   | 137/206 [40:55<20:36,  0.06it/s]Testing DataLoader 0:  67%|██████▋   | 138/206 [41:13<20:18,  0.06it/s]Testing DataLoader 0:  67%|██████▋   | 139/206 [41:31<20:01,  0.06it/s]Testing DataLoader 0:  68%|██████▊   | 140/206 [41:49<19:43,  0.06it/s]Testing DataLoader 0:  68%|██████▊   | 141/206 [42:07<19:25,  0.06it/s]Testing DataLoader 0:  69%|██████▉   | 142/206 [42:25<19:07,  0.06it/s]Testing DataLoader 0:  69%|██████▉   | 143/206 [42:43<18:49,  0.06it/s]Testing DataLoader 0:  70%|██████▉   | 144/206 [43:01<18:31,  0.06it/s]Testing DataLoader 0:  70%|███████   | 145/206 [43:19<18:13,  0.06it/s]Testing DataLoader 0:  71%|███████   | 146/206 [43:37<17:55,  0.06it/s]Testing DataLoader 0:  71%|███████▏  | 147/206 [43:55<17:37,  0.06it/s]Testing DataLoader 0:  72%|███████▏  | 148/206 [44:13<17:19,  0.06it/s]Testing DataLoader 0:  72%|███████▏  | 149/206 [44:30<17:01,  0.06it/s]Testing DataLoader 0:  73%|███████▎  | 150/206 [44:48<16:43,  0.06it/s]Testing DataLoader 0:  73%|███████▎  | 151/206 [45:06<16:25,  0.06it/s]Testing DataLoader 0:  74%|███████▍  | 152/206 [45:24<16:08,  0.06it/s]Testing DataLoader 0:  74%|███████▍  | 153/206 [45:42<15:50,  0.06it/s]Testing DataLoader 0:  75%|███████▍  | 154/206 [46:05<15:33,  0.06it/s]Testing DataLoader 0:  75%|███████▌  | 155/206 [46:23<15:15,  0.06it/s]Testing DataLoader 0:  76%|███████▌  | 156/206 [46:41<14:57,  0.06it/s]Testing DataLoader 0:  76%|███████▌  | 157/206 [46:59<14:39,  0.06it/s]Testing DataLoader 0:  77%|███████▋  | 158/206 [47:17<14:21,  0.06it/s]Testing DataLoader 0:  77%|███████▋  | 159/206 [47:35<14:03,  0.06it/s]Testing DataLoader 0:  78%|███████▊  | 160/206 [47:53<13:46,  0.06it/s]Testing DataLoader 0:  78%|███████▊  | 161/206 [48:10<13:27,  0.06it/s]Testing DataLoader 0:  79%|███████▊  | 162/206 [48:28<13:10,  0.06it/s]Testing DataLoader 0:  79%|███████▉  | 163/206 [48:46<12:52,  0.06it/s]Testing DataLoader 0:  80%|███████▉  | 164/206 [49:04<12:34,  0.06it/s]Testing DataLoader 0:  80%|████████  | 165/206 [49:22<12:16,  0.06it/s]Testing DataLoader 0:  81%|████████  | 166/206 [49:40<11:58,  0.06it/s]Testing DataLoader 0:  81%|████████  | 167/206 [49:58<11:40,  0.06it/s]Testing DataLoader 0:  82%|████████▏ | 168/206 [50:16<11:22,  0.06it/s]Testing DataLoader 0:  82%|████████▏ | 169/206 [50:34<11:04,  0.06it/s]Testing DataLoader 0:  83%|████████▎ | 170/206 [50:52<10:46,  0.06it/s]Testing DataLoader 0:  83%|████████▎ | 171/206 [51:10<10:28,  0.06it/s]Testing DataLoader 0:  83%|████████▎ | 172/206 [51:28<10:10,  0.06it/s]Testing DataLoader 0:  84%|████████▍ | 173/206 [51:46<09:52,  0.06it/s]Testing DataLoader 0:  84%|████████▍ | 174/206 [52:04<09:34,  0.06it/s]Testing DataLoader 0:  85%|████████▍ | 175/206 [52:22<09:16,  0.06it/s]Testing DataLoader 0:  85%|████████▌ | 176/206 [52:40<08:58,  0.06it/s]Testing DataLoader 0:  86%|████████▌ | 177/206 [52:58<08:40,  0.06it/s]Testing DataLoader 0:  86%|████████▋ | 178/206 [53:16<08:22,  0.06it/s]Testing DataLoader 0:  87%|████████▋ | 179/206 [53:34<08:04,  0.06it/s]Testing DataLoader 0:  87%|████████▋ | 180/206 [53:52<07:46,  0.06it/s]Testing DataLoader 0:  88%|████████▊ | 181/206 [54:10<07:28,  0.06it/s]Testing DataLoader 0:  88%|████████▊ | 182/206 [54:27<07:10,  0.06it/s]Testing DataLoader 0:  89%|████████▉ | 183/206 [54:45<06:52,  0.06it/s]Testing DataLoader 0:  89%|████████▉ | 184/206 [55:03<06:35,  0.06it/s]Testing DataLoader 0:  90%|████████▉ | 185/206 [55:21<06:17,  0.06it/s]Testing DataLoader 0:  90%|█████████ | 186/206 [55:39<05:59,  0.06it/s]Testing DataLoader 0:  91%|█████████ | 187/206 [55:56<05:41,  0.06it/s]Testing DataLoader 0:  91%|█████████▏| 188/206 [56:14<05:23,  0.06it/s]Testing DataLoader 0:  92%|█████████▏| 189/206 [56:31<05:05,  0.06it/s]Testing DataLoader 0:  92%|█████████▏| 190/206 [56:49<04:47,  0.06it/s]Testing DataLoader 0:  93%|█████████▎| 191/206 [57:07<04:29,  0.06it/s]Testing DataLoader 0:  93%|█████████▎| 192/206 [57:24<04:11,  0.06it/s]Testing DataLoader 0:  94%|█████████▎| 193/206 [57:42<03:53,  0.06it/s]Testing DataLoader 0:  94%|█████████▍| 194/206 [57:59<03:35,  0.06it/s]Testing DataLoader 0:  95%|█████████▍| 195/206 [58:17<03:17,  0.06it/s]Testing DataLoader 0:  95%|█████████▌| 196/206 [58:35<02:59,  0.06it/s]Testing DataLoader 0:  96%|█████████▌| 197/206 [58:52<02:41,  0.06it/s]Testing DataLoader 0:  96%|█████████▌| 198/206 [59:10<02:23,  0.06it/s]Testing DataLoader 0:  97%|█████████▋| 199/206 [59:27<02:05,  0.06it/s]Testing DataLoader 0:  97%|█████████▋| 200/206 [59:45<01:47,  0.06it/s]Testing DataLoader 0:  98%|█████████▊| 201/206 [1:00:03<01:29,  0.06it/s]Testing DataLoader 0:  98%|█████████▊| 202/206 [1:00:20<01:11,  0.06it/s]Testing DataLoader 0:  99%|█████████▊| 203/206 [1:00:38<00:53,  0.06it/s]Testing DataLoader 0:  99%|█████████▉| 204/206 [1:00:55<00:35,  0.06it/s]Testing DataLoader 0: 100%|█████████▉| 205/206 [1:01:13<00:17,  0.06it/s]Testing DataLoader 0: 100%|██████████| 206/206 [1:01:18<00:00,  0.06it/s]Testing DataLoader 0: 100%|██████████| 206/206 [1:01:23<00:00,  0.06it/s]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
        Test metric                 DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 test/Accuracy_1_km_radius     0.0011469527380540967
test/Accuracy_200_km_radius      0.4837380051612854
test/Accuracy_2500_km_radius     0.815364420413971
 test/Accuracy_25_km_radius     0.17440344393253326
test/Accuracy_750_km_radius      0.668345034122467
     test/Accuracy_city         0.062182921916246414
   test/Accuracy_country         0.6787675619125366
    test/Accuracy_region         0.399720162153244
  test/Accuracy_sub-region      0.10593845695257187
       test/Geoguessr            3360.720947265625
       test/Haversine            1843.7308349609375
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
